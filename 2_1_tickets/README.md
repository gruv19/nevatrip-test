# 1. Билеты на событие

**Вопрос 1.** Некоторые события нужно продавать с дополнительными типами билетов - льготный и групповой, у которых будут свои цены и название. Имеется информация, что вероятно, будут другие типы билетов, которые нужно будет добавить. Нужно уметь сохранять при заказе 2 дополнительных типа билета, льготный и групповой в бд. Задача - Показать конечный вид таблицы с добавленными типами билетов. Объяснить свое решение.

**Вопрос 2.** Часто посетители из одного заказа приходят не одновременно на события. Возникает необходимость чекинить их по отдельности. Для этого у каждого билета должен быть свой баркод. Если в одном заказе было куплено несколько билетов, 2 взрослых, 3 детских, 4 льготных - то должно быть 9 баркодов для каждого билета соответственно. Задача - Показать конечный вид таблицы, где у каждого билета свой баркод. Объяснить свое решение.

## Решение

**Относительно 1-го вопроса**, в таблице поля `ticket_adult_price` и `ticket_adult_quantity`, а также `ticket_kid_price` и `ticket_kid_quantity` показывают стоимость	и количество уже 2-х имеющихся типов билетов. В задании предложено добавить еще 2 типа билетов, но при этом говорится, что "вероятно, будут другие типы билетов". Поэтому добавление новых полей в таблицу (например, `ticket_group_price` и `ticket_group_quantity`) будет некорректно, т.к. это лишит таблицу гибкости.
По моему мнению, типы билетов необходимо вынести в отдельную таблицу `ticket_types` с полями: 
* `id` - инкрементальный (уникальный) порядковый номер типа билета 
* `title` - название типа (взрослый, детский, групповой, льготный и пр.)

В описании сказано, что "У каждого события есть название, описание, расписание, цены и свой уникальный ид", т.е. есть таблица `events` с полями:
* `id` - инкрементальный (уникальный) порядковый номер события
* `title` - название события
* `description` - описание события
* `schedule` - расписание

Поле стоимости я умышленно не указал, т.к. стоимость билета разная для разных событий и разных типов билетов. Чтобы реализовать данный функционал нужна вспомогательная таблица `ticket_prices` с полями:
* `id` - инкрементальный (уникальный) порядковый записи
* `event_id` - ид события  (будет ссылаться на поле `id` таблицы `events`)
* `ticket_type_id` - ид типа билета (будет ссылаться на поле `id` таблицы `ticket_types`)
* `price` - стоимость билета

В связи с тем, что заказе, может быть несколько билетов, считаю, что необходимо также информацию о билетах вынести в отдельную таблицу `tickets` с полями:
* `id` - инкрементальный (уникальный) порядковый номер билета 
* `order_id` - ид заказа, в котором куплен данный билет (будет ссылаться на поле `id` таблицы `orders`)
* `type_id` - ид типа билета (будет ссылаться на поле `id` таблицы `ticket_types`)
* `event_id` - ид события, на которое куплен билет (будет ссылаться на поле `id` таблицы `events`)
* `event_date` - дата и время, на которое были куплен билет

Таким образом исходную талицу `orders` можно преобразовать в следующий вид:
* `id` - инкрементальный (уникальный) порядковый номер заказа
* `barcode` - уникальный штрих-код заказа
* `user_id` - ид покупателя
* `equal_price` - общая сумма заказа
* `created` - дата создания заказа

![БД после 1-го задания](https://github.com/gruv19/nevatrip-test/blob/master/2_1_tickets/db_1.jpg)

**Во 2-м вопросе**,  указано, что `barcode` становиться характеристикой не заказа, а билета, поэтому достаточно из талицы `orders` убрать поле `barcode`, а таблицу `tickets` привести к виду:
* `id` - инкрементальный (уникальный) порядковый номер билета 
* `order_id` - ид заказа, в котором куплен данный билет (будет ссылаться на поле `id` таблицы `orders`)
* `type_id` - ид типа билета (будет ссылаться на поле `id` таблицы `ticket_types`)
* `event_id` - ид события, на которое куплен билет (будет ссылаться на поле `id` таблицы `events`)
* `event_date` - дата и время, на которое были куплен билет
* `barcode` - уникальный штрих-код билета
* `check_in` - отметка об использовании (true/false)

![БД после 1-го задания](https://github.com/gruv19/nevatrip-test/blob/master/2_1_tickets/db_2.jpg)